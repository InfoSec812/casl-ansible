# Copyright 2018 Red Hat, Inc.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#      http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
  
- name: Download Groovy Artifact
  get_url: 
    url: "{{ groovy_url }}"
    dest: "{{ groovy_local_archive }}"
  tags: groovy
 
- name: Extract Groovy Artifact
  unarchive: 
      src: "{{ groovy_local_archive }}"
      dest: "{{ groovy_base_dir }}"
      copy: no 
      creates: "{{ groovy_install_dir }}"
  tags: groovy

- name: Create Groovy Symbolic Link
  file: 
      src: "{{ groovy_install_dir }}"
      dest: "{{ groovy_base_dir }}/groovy"
      state: link
  tags: groovy

- name: Add GROOVY_HOME Variable
  lineinfile: 
    dest: /etc/profile 
    regexp: "^export GROOVY_HOME=/usr/local/groovy-{{groovy_version}}"
    line: "export GROOVY_HOME=/usr/local/groovy-{{groovy_version}}"
  tags: groovy
  
- name: Add GROOVY_HOME to PATH
  lineinfile: 
    dest: /etc/profile
    regexp: "^export PATH=$PATH:$GROOVY_HOME/bin"
    line: "export PATH=$PATH:$GROOVY_HOME/bin"
  tags: groovy